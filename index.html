<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>포인트 게임</title>
<style>
  body {
    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    margin: 0; padding: 0;
    display: flex;
    flex-direction: column;
    min-height: 100vh;
    background: #f0f4f8;
    color: #222;
    justify-content: center;
    align-items: center;
    text-align: center;
  }
  #start-screen, #countdown-screen, #game-screen, #result-screen {
    width: 90%;
    max-width: 400px;
  }
  h1 {
    font-size: 1.5rem;
    margin-bottom: 1.5rem;
  }
  button {
    font-size: 1.2rem;
    padding: 12px 24px;
    border-radius: 8px;
    border: none;
    background-color: #007bff;
    color: white;
    cursor: pointer;
    user-select: none;
  }
  button:active {
    background-color: #0056b3;
  }
  #countdown-number {
    font-size: 3rem;
    font-weight: bold;
    margin: 1rem 0 2rem 0;
  }
  #point-display {
    font-size: 2rem;
    font-weight: 700;
    margin-bottom: 1.5rem;
  }
  .gui-container {
    display: flex;
    flex-direction: column;
    gap: 20px;
    margin-bottom: 2rem;
  }
  .gui-item {
    display: flex;
    flex-direction: column;
    align-items: center;
  }
  label {
    margin-bottom: 6px;
    font-weight: 600;
  }
  input[type=range] {
    width: 100%;
  }
  .interaction-count {
    font-size: 0.85rem;
    color: #555;
    margin-top: 4px;
  }
  #result-screen h2 {
    margin-bottom: 1rem;
  }
  #result-screen ul {
    list-style: none;
    padding: 0;
    text-align: left;
  }
  #result-screen ul li {
    margin-bottom: 0.5rem;
    font-size: 1rem;
  }
</style>
</head>
<body>

<!-- 시작 화면 -->
<div id="start-screen">
  <h1>포인트를 많이 받으세요</h1>
  <button id="start-btn">시작</button>
</div>

<!-- 카운트다운 화면 -->
<div id="countdown-screen" style="display:none;">
  <h1>시작까지</h1>
  <div id="countdown-number">5</div>
</div>

<!-- 게임 화면 -->
<div id="game-screen" style="display:none;">
  <div id="point-display">포인트: 0</div>
  <div class="gui-container">
    <div class="gui-item" data-gui-id="slider1">
      <label for="slider1">슬라이더 1</label>
      <input type="range" id="slider1" min="0" max="100" value="50" />
      <div class="interaction-count">상호작용: 0</div>
    </div>
    <div class="gui-item" data-gui-id="slider2">
      <label for="slider2">슬라이더 2</label>
      <input type="range" id="slider2" min="0" max="100" value="50" />
      <div class="interaction-count">상호작용: 0</div>
    </div>
    <div class="gui-item" data-gui-id="btn1">
      <button id="btn1">버튼 1</button>
      <div class="interaction-count">상호작용: 0</div>
    </div>
    <div class="gui-item" data-gui-id="btn2">
      <button id="btn2">버튼 2</button>
      <div class="interaction-count">상호작용: 0</div>
    </div>
  </div>
  <div>남은 시간: <span id="game-timer">20</span>초</div>
</div>

<!-- 결과 화면 -->
<div id="result-screen" style="display:none;">
  <h2>게임 종료!</h2>
  <p id="final-point"></p>
  <ul id="interaction-results"></ul>
  <button id="restart-btn">다시하기</button>
</div>

<script>
  const startScreen = document.getElementById('start-screen');
  const countdownScreen = document.getElementById('countdown-screen');
  const countdownNumber = document.getElementById('countdown-number');
  const gameScreen = document.getElementById('game-screen');
  const pointDisplay = document.getElementById('point-display');
  const gameTimerDisplay = document.getElementById('game-timer');
  const resultScreen = document.getElementById('result-screen');
  const finalPointEl = document.getElementById('final-point');
  const interactionResults = document.getElementById('interaction-results');
  const restartBtn = document.getElementById('restart-btn');

  let totalPoints = 0;
  let countdown = 5;
  let gameTime = 20;
  let pointInterval, gameInterval;

  // GUI interaction tracking
  const guiItems = document.querySelectorAll('.gui-item');
  // { guiId: interactionCount }
  const interactionCounts = {};
  guiItems.forEach(item => {
    const id = item.getAttribute('data-gui-id');
    interactionCounts[id] = 0;
  });

  // GUI 이벤트 연결
  function setupGuiListeners() {
    guiItems.forEach(item => {
      const id = item.getAttribute('data-gui-id');
      if (item.querySelector('input[type=range]')) {
        const slider = item.querySelector('input[type=range]');
        slider.addEventListener('input', () => {
          interactionCounts[id]++;
          updateInteractionCountDisplay(item, interactionCounts[id]);
        });
      } else if (item.querySelector('button')) {
        const btn = item.querySelector('button');
        btn.addEventListener('click', () => {
          interactionCounts[id]++;
          updateInteractionCountDisplay(item, interactionCounts[id]);
        });
      }
    });
  }

  function updateInteractionCountDisplay(item, count) {
    const countDisplay = item.querySelector('.interaction-count');
    countDisplay.textContent = `상호작용: ${count}`;
  }

  function resetInteractionCounts() {
    guiItems.forEach(item => {
      const id = item.getAttribute('data-gui-id');
      interactionCounts[id] = 0;
      updateInteractionCountDisplay(item, 0);
    });
  }

  // 시작 버튼 클릭
  document.getElementById('start-btn').addEventListener('click', () => {
    startScreen.style.display = 'none';
    countdownScreen.style.display = 'block';
    countdown = 5;
    countdownNumber.textContent = countdown;

    const countdownTimer = setInterval(() => {
      countdown--;
      if (countdown > 0) {
        countdownNumber.textContent = countdown;
      } else {
        clearInterval(countdownTimer);
        startGame();
      }
    }, 1000);
  });

  // 게임 시작
  function startGame() {
    countdownScreen.style.display = 'none';
    gameScreen.style.display = 'block';
    totalPoints = 0;
    pointDisplay.textContent = `포인트: ${totalPoints}`;
    gameTime = 20;
    gameTimerDisplay.textContent = gameTime;
    resetInteractionCounts();
    setupGuiListeners();

    // 1초마다 랜덤 포인트 더하기
    pointInterval = setInterval(() => {
      const randAdd = Math.floor(Math.random() * 6); // 0~5
      totalPoints += randAdd;
      pointDisplay.textContent = `포인트: ${totalPoints}`;
    }, 1000);

    // 게임 제한시간 카운트다운
    gameInterval = setInterval(() => {
      gameTime--;
      gameTimerDisplay.textContent = gameTime;
      if (gameTime <= 0) {
        endGame();
      }
    }, 1000);
  }

  // 게임 종료
  function endGame() {
    clearInterval(pointInterval);
    clearInterval(gameInterval);
    gameScreen.style.display = 'none';
    resultScreen.style.display = 'block';

    finalPointEl.textContent = `최종 포인트: ${totalPoints}`;
    interactionResults.innerHTML = '';

    for (const [guiId, count] of Object.entries(interactionCounts)) {
      const li = document.createElement('li');
      li.textContent = `${guiId} 상호작용 횟수: ${count}`;
      interactionResults.appendChild(li);
    }
  }

  // 다시하기 버튼
  restartBtn.addEventListener('click', () => {
    resultScreen.style.display = 'none';
    startScreen.style.display = 'block';
  });
</script>

</body>
</html>
